<!-- <?
        $db = mysqli_connect('server-name', 'user-name', 'password', 'database-name');
        $query = "SELECT * FROM category";
        $result = mysqli_query($db, $query);
        if(!$result){
             die(mysqli_error());
             exit();
        }
?> -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse Categories</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <style>
        .text-font{
            font-size: 35px;
            font-weight: bolder;
        }
        .height{
            height: 100vh   ;
        }
        .error{
                color: red;
                font-size: large;
            
            }
            .success{
                color: green;
                font-size: large;
          
            }
            .error1{
                color: red;
                font-size: large;
            
            }
            .success1{
                color: green;
                font-size: large;
          
            }
            .error2{
                color: red;
                font-size: large;
            
            }
            .success2{
                color: green;
                font-size: large;
          
            }
    </style>
       
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-2 bg-dark height">
                <p class="pt-5 pb-5 text-center">
                    <a href="admin-panel.php" class="text-decoration-none"><span class="text-light text-font">Admin</span></a>
                </p>
                <hr class="bg-light ">
                 <p class="pt-2 pb-2 text-center">
                    <a href="admin-profile.php" class="text-decoration-none"><span class="text-light">Profile</span></a>
                </p>
                <hr class="bg-light ">
                 <p class="pt-2 pb-2 text-center">
                    <a href="add-categories.php" class="text-decoration-none"><span class="text-light">Add Categories</span></a>
                </p>
                <hr class="bg-light ">
                 <p class="pt-2 pb-2 text-center">
                    <a href="display-categories.php" class="text-decoration-none"><span class="text-light">Display Categories</span></a>
                </p>
                
                <hr class="bg-light ">
                <p class="pt-2 pb-2 text-center">
                    <a href="products-add.php" class="text-decoration-none"><span class="text-light">Add Products</span></a>
                </p>
                <hr class="bg-light ">
                <p class="pt-2 pb-2 text-center">
                    <a href="products-display.php" class="text-decoration-none"><span class="text-light">View Products</span></a>
                </p>
                <hr class="bg-light ">
                <p class="pt-2 pb-2 text-center">
                    <a href="new-user-requests.php" class="text-decoration-none"><span class="text-light">New user requests</span></a>
                </p>
                <hr class="bg-light ">
                <p class="pt-2 pb-2 text-center">
                    <a href="view-users.php" class="text-decoration-none"><span class="text-light">View user</span></a>
                </p>                
                <hr class="bg-light ">
                
                
                
            </div>
            <div class="col-sm-10 bg-light">
               <div class="row">
                   <div class="col-sm-2">
                       <p class="text-center pt-5">
                                    <img class="rounded" src="<?php echo ("/test123/profile-pic/") . ($_SESSION['email']) . "display-picture.jpg"; ?>" width="150px" height="140px">
                                </p>
                   </div>
                   <div class="col-sm-8">
                       <h1 class="text-center pt-4 pb-5"><strong>Browse Categories/Subcategories</strong>
                       <hr class="w-25 mx-auto">
                   </div>
                   <div class="col-sm-2">
                       <p class="pt-5 text-center">
                            <a href="logout.php" class="btn btn-outline-primary">Logout</a>
                       </p>
                   </div>
               </div>
                <div class="row ">
                    
                    <div class="col-sm-10 w-50 mx-auto rounded bg-white">
                        <h3 class="text-center pt-2 pb-5">
                            <strong>Delete/Edit Categories</strong>
                        </h3>
                        <ol>
                            <?php 
                                    $db = mysqli_connect('server-name', 'user-name', 'password', 'database-name');
                                    $query = "SELECT * FROM category";
                                    $result = mysqli_query($db, $query);
                                    if(!$result){
                                         die(mysqli_error());
                                         exit();
                                    }
                                    while($row = mysqli_fetch_array($result, MYSQLI_ASSOC)){ ?>
                                        <li>
                                            
                                            <form action="del-category.php" method="post">
                                                <?php echo ($row['name']); ?> 
                                            <input type="hidden" name="category-name" value="<?php echo ($row['name']); ?> ">
                                            <button type="submit" class="btn btn-link text-decoration-none">Delete</button>
                                            </form>
                                            <ol>
                                                <?php 
                                                        $db1 = mysqli_connect('server-name', 'user-name', 'password', 'database-name');
                                                        $ID = $row['id'];
                                                        $query1 = "SELECT * FROM subcategory WHERE id='$ID' ";
                                                        $result1 = mysqli_query($db1, $query1);
                                                        if(!$result1){
                                                             die(mysqli_error());
                                                             exit();
                                                        }
                                                        while($row1 = mysqli_fetch_array($result1, MYSQLI_ASSOC)){ ?>
                                                            <li>
                                                                <form action="del-subcategory.php" method="post">
                                                                    <?php echo ($row1['name']); ?> 
                                                                    <input type="hidden" name="subcategory-id" value="<?php echo ($row1['sid']); ?> ">
                                                                    <button type="submit" class="btn btn-link text-decoration-none">Delete</button>
                                                                </form>
                                                            </li>
                                                <?php } ?>
                                            </ol>
                                        </li>
                            <?php } ?>
                        </ol>
                    </div>
                    <div class="error2"></div><div class="success2"></div>
                    <script>
                        
                        function addcategory(){
                            var x = $('#category').val();
                            var input = {
                                "category" : x,
                                "action" : 'addcategory'
                            };
                            $.ajax({
                                url : 'controller.php',
                                type : 'POST',
                                dataType : "json",
                                data : input,
                                success : function(response)
                                {
                                    $('.success').html(response.message).show();
                                    $('.error').hide();
                                },
                                error : function(response)
                                {
                                     $('.error').html("Sub category already exist.").show();
                                     $('.success').hide();
                                }
                            });
                            
                        }
                        function addsubcategory(){
                            var x = $('#subcategory').val();
                            var id = $('#categories').val();
                            var input = {
                                "subcategory" : x,
                                "id" : id,
                                "action" : 'addsubcategory'
                            };
                            $.ajax({
                                url : 'controller.php',
                                type : 'POST',
                                dataType : "json",
                                data : input,
                                success : function(response)
                                {
                                    $('.success1').html(response.message).show();
                                    $('.error1').hide();
                                },
                                error : function(response)
                                {
                                     $('.error1').html("Sub category already exist.").show();
                                     $('.success1').hide();
                                }
                            });
                            
                        }
                    </script>
                </div>
            </div>
        </div>
    </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</body>
</html>